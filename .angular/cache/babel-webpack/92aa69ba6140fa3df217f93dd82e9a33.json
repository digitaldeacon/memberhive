{"ast":null,"code":"import _classCallCheck from \"/Applications/MAMP/htdocs/memberhive/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Applications/MAMP/htdocs/memberhive/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport { FormControl } from '@angular/forms';\nimport { SearchService } from './search.service';\nimport { Router } from '@angular/router';\nimport { Subject } from 'rxjs';\nimport { debounceTime, distinctUntilChanged, switchMap, tap } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./search.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/flex-layout/flex\";\nimport * as i4 from \"@angular/material/form-field\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/material/input\";\nimport * as i7 from \"@angular/material/autocomplete\";\nimport * as i8 from \"@angular/forms\";\nimport * as i9 from \"@angular/material/icon\";\nimport * as i10 from \"@angular/material/progress-spinner\";\nimport * as i11 from \"@angular/material/core\";\n\nfunction SearchBoxComponent_mat_icon_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-icon\", 8);\n    i0.ɵɵtext(1, \"search\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction SearchBoxComponent_mat_spinner_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"mat-spinner\", 8);\n  }\n}\n\nfunction SearchBoxComponent_mat_option_8_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r7 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"mat-option\", 9);\n    i0.ɵɵlistener(\"click\", function SearchBoxComponent_mat_option_8_Template_mat_option_click_0_listener() {\n      var restoredCtx = i0.ɵɵrestoreView(_r7);\n      var item_r5 = restoredCtx.$implicit;\n      var ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.resultClicked(item_r5);\n    });\n    i0.ɵɵelement(1, \"img\", 10);\n    i0.ɵɵelementStart(2, \"span\", 11);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var item_r5 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", item_r5);\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"src\", item_r5.icon, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r5.text);\n  }\n}\n\nexport var SearchBoxComponent = /*#__PURE__*/(function () {\n  var SearchBoxComponent = /*#__PURE__*/function () {\n    function SearchBoxComponent(_searchService, _router) {\n      _classCallCheck(this, SearchBoxComponent);\n\n      this._searchService = _searchService;\n      this._router = _router;\n      this._searchVisible = false;\n      this._searchTermStream$ = new Subject();\n      this.searchInFocus = false;\n      this.searching = false;\n      this.itemCtrl = new FormControl();\n    }\n\n    _createClass(SearchBoxComponent, [{\n      key: \"searchVisible\",\n      get: function get() {\n        return this._searchVisible;\n      }\n    }, {\n      key: \"search\",\n      value: function search(term) {\n        this._searchTermStream$.next(term);\n      }\n    }, {\n      key: \"ngOnInit\",\n      value: function ngOnInit() {\n        var _this = this;\n\n        this.items = this._searchTermStream$.pipe(debounceTime(300), distinctUntilChanged(), tap(function () {\n          return _this.searching = true;\n        }), switchMap(function (term) {\n          return _this._searchService.search(term);\n        }), tap(function () {\n          return _this.searching = false;\n        }));\n      }\n    }, {\n      key: \"searchClicked\",\n      value: function searchClicked() {\n        if (!this._searchVisible) {\n          this.itemCtrl.reset();\n        }\n\n        this.toggleVisibility();\n      }\n    }, {\n      key: \"selected\",\n      value: function selected(event) {\n        var searchObj = event.option.value;\n\n        if (searchObj.url.length === 2) {\n          this.itemCtrl.reset();\n\n          this._router.navigate([searchObj.url[0] + '/' + searchObj.url[1]]);\n        }\n      }\n    }, {\n      key: \"toggleVisibility\",\n      value: function toggleVisibility() {\n        this._searchVisible = !this._searchVisible;\n      }\n    }, {\n      key: \"resultClicked\",\n      value: function resultClicked(item) {\n        this.itemCtrl.reset();\n\n        this._router.navigate(item.url);\n      }\n    }]);\n\n    return SearchBoxComponent;\n  }();\n\n  SearchBoxComponent.ɵfac = function SearchBoxComponent_Factory(t) {\n    return new (t || SearchBoxComponent)(i0.ɵɵdirectiveInject(i1.SearchService), i0.ɵɵdirectiveInject(i2.Router));\n  };\n\n  SearchBoxComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: SearchBoxComponent,\n    selectors: [[\"mh-search-box\"]],\n    decls: 10,\n    vars: 9,\n    consts: [[\"fxFlex\", \"\", 1, \"mh-search-box\"], [\"floatPlaceholder\", \"never\"], [\"matPrefix\", \"\", 4, \"ngIf\"], [\"matInput\", \"\", \"type\", \"search\", 3, \"matAutocomplete\", \"formControl\", \"focus\", \"blur\", \"keyup\", \"clear\"], [\"term\", \"\"], [3, \"optionSelected\"], [\"auto\", \"matAutocomplete\"], [\"class\", \"item\", 3, \"value\", \"click\", 4, \"ngFor\", \"ngForOf\"], [\"matPrefix\", \"\"], [1, \"item\", 3, \"value\", \"click\"], [\"alt\", \"...\", 3, \"src\"], [1, \"text\"]],\n    template: function SearchBoxComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        var _r8 = i0.ɵɵgetCurrentView();\n\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"mat-form-field\", 1);\n        i0.ɵɵtemplate(2, SearchBoxComponent_mat_icon_2_Template, 2, 0, \"mat-icon\", 2);\n        i0.ɵɵtemplate(3, SearchBoxComponent_mat_spinner_3_Template, 1, 0, \"mat-spinner\", 2);\n        i0.ɵɵelementStart(4, \"input\", 3, 4);\n        i0.ɵɵlistener(\"focus\", function SearchBoxComponent_Template_input_focus_4_listener() {\n          return ctx.searchInFocus = true;\n        })(\"blur\", function SearchBoxComponent_Template_input_blur_4_listener() {\n          return ctx.searchInFocus = false;\n        })(\"keyup\", function SearchBoxComponent_Template_input_keyup_4_listener() {\n          i0.ɵɵrestoreView(_r8);\n\n          var _r2 = i0.ɵɵreference(5);\n\n          return ctx.search(_r2.value);\n        })(\"clear\", function SearchBoxComponent_Template_input_clear_4_listener() {\n          return ctx.toggleVisibility();\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"mat-autocomplete\", 5, 6);\n        i0.ɵɵlistener(\"optionSelected\", function SearchBoxComponent_Template_mat_autocomplete_optionSelected_6_listener($event) {\n          return ctx.selected($event);\n        });\n        i0.ɵɵtemplate(8, SearchBoxComponent_mat_option_8_Template, 4, 3, \"mat-option\", 7);\n        i0.ɵɵpipe(9, \"async\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        var _r3 = i0.ɵɵreference(7);\n\n        i0.ɵɵadvance(1);\n        i0.ɵɵclassProp(\"active\", ctx.searchInFocus);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.searching);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.searching);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"matAutocomplete\", _r3)(\"formControl\", ctx.itemCtrl);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(9, 7, ctx.items));\n      }\n    },\n    directives: [i3.DefaultFlexDirective, i4.MatFormField, i5.NgIf, i6.MatInput, i7.MatAutocompleteTrigger, i8.DefaultValueAccessor, i8.NgControlStatus, i8.FormControlDirective, i7.MatAutocomplete, i5.NgForOf, i9.MatIcon, i4.MatPrefix, i10.MatSpinner, i11.MatOption],\n    pipes: [i5.AsyncPipe],\n    styles: [\"var[_ngcontent-%COMP%]   resource[_ngcontent-%COMP%]{}(function()[_ngcontent-%COMP%] {var __webpack_modules__ = ({987: (function() {throw new Error(\\\"Module build failed (from ./node_modules/sass-loader/dist/cjs.js):nSassError: expected selector.n   \\\\2577n18 \\\\2502      /deep/{n   \\\\2502      ^n   \\\\2575n  apps/web/src/app/search/search-box.component.scss 18:5  root stylesheet\\\");})}); var __webpack_exports__ = {}; __webpack_modules__[987](); resource = __webpack_exports__;})()[_ngcontent-%COMP%]{}\"]\n  });\n  return SearchBoxComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}